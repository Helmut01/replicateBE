<!DOCTYPE html>

<html lang="en" xml:lang="en">

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>replicateBE</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body{background-color:#fff;margin:1em auto;max-width:700px;overflow:visible;padding-left:2em;padding-right:2em;font-family:"Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;font-size:14px;line-height:1.35;hyphens:auto}#header{text-align:center}#TOC{clear:both;margin:0 0 10px 10px;padding:4px;width:400px;border:1px solid #CCC;border-radius:5px;background-color:#f6f6f6;font-size:13px;line-height:1.2em}#TOC .toctitle{font-weight:bold;font-size:15px;margin-left:5px}#TOC ul{padding-left:40px;margin-left:-1.5em;margin-top:5px;margin-bottom:5px}#TOC ul ul{margin-left:-2em}#TOC li{list-style-type:none;line-height:16px}table{margin:1em auto;border-width:1px;border-color:#DDD;border-style:outset;border-collapse:collapse}table th{border-width:2px;padding:5px;border-style:inset}table td{border-width:1px;border-style:inset;line-height:18px;padding:5px 5px}table, table th, table td{border-left-style:none;border-right-style:none}table thead, table tr.even{background-color:#f7f7f7}p{margin:0.5em 0}sup, sub{position:relative;vertical-align:baseline;top:-0.4em}sub{top:0.4em}blockquote{background-color:#fffff6;padding:0.25em 0.75em}hr{border-style:solid;border:none;border-top:1px solid #777;margin:28px 0}dl{margin-left:0}dl dd{margin-bottom:13px;margin-left:13px}dl dt{font-weight:bold}ul{margin-top:0}ul li{list-style:circle outside}ul ul{margin-bottom:0}pre, code{background-color:#f7f7f7;border-radius:3px;color:#333;white-space:pre-wrap}pre{border-radius:3px;margin:5px 0px 10px 0px;padding:10px}pre:not([class]){background-color:#f7f7f7}code{font-size:85%; font-family:Consolas, Monaco, 'Lucida Console','Courier New', 'Courier', monospace}p > code, li > code{padding:2px 0px}div.figure{text-align:center}img{background-color:#FFF;padding:2px;border:1px solid #DDD;border-radius:5px;border:1px solid #CCC;margin:0 5px}h1{margin-top:0;padding-top:10px;padding-bottom:4px;border-bottom:3px solid #f7f7f7;font-size:175%;line-height:30px;letter-spacing:.5px}h2{border-bottom:2px solid #f7f7f7;padding-top:10px;padding-bottom:2px;font-size:145%}h3{border-bottom:1px solid #f7f7f7;padding-top:10px;font-size:120%}h4{margin-left:8px;font-size:110%}.author{font-size:91%;margin-left:0;margin-bottom:0;font-style:normal}h5, h6{border-bottom:1px solid #ccc;font-size:105%}a{color:#0033dd;text-decoration:none}a:hover{color:#6666ff}a:visited{color:#800080}a:visited:hover{color:#BB00BB}a[href^="http:"]{color:#696969;border-bottom:1px dotted #000}a[href^="https:"]{border-bottom:1px dotted #000;color:#696969}code > span.kw{color:#555;font-weight:bold} code > span.dt{color:#902000} code > span.dv{color:#40a070} code > span.bn{color:#d14} code > span.fl{color:#d14} code > span.ch{color:#d14} code > span.st{color:#d14} code > span.co{color:#888888;font-style:italic} code > span.ot{color:#007020} code > span.al{color:#ff0000;font-weight:bold} code > span.fu{color:#900;font-weight:bold}  code > span.er{color:#a61717;background-color:#e3d2d2} .top{display:inline;position:fixed;bottom:0;right:0;padding:0;font-size:108px;width:30px}.top img{border:none}a.toplink:link{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAAAXVBMVEUAAABcgJzu7u/+///t7u9ri6XN1+G1xdKtv82nusl2k6tkhqH6+/zZ4uiGoLVvj6je4+eXrsCTq71ujKbAzdehtMScscGNprl7mK9fgp7k6Ork5+rX3uPT2+Foh6ODMk/HAAAAAXRSTlMAQObYZgAAANFJREFUKM+Fk+0aQzAMRpsW1XZlmGFf93+ZM4skxji/1OHp2zRRhImu8CH4wkWjfjnZFIjUnpY2K2FBmQlpcliRG7IVbFDNPodNctwX/pBNmWUq38p8n/wWmFrrCzB2zJWKpR55DHx+oyIthqeeuPMPUTn69KaRpAfEqQKf+kQzHb4slKdQEocHUeFbgqWdDxBQh1dzZXdumhS1B6QTmqpE0aCWmqK5Pe24LNWGjlxUGY2KylfSrrUVF1olREYXutsO+8100Ir7jXw0BsdDdDCCb/erCdkTmcUbAAAAAElFTkSuQmCC);background-repeat:no-repeat;text-decoration:none;background-color:transparent;opacity:.6;filter:alpha(opacity=60);background-position:bottom 7px right;background-size:contain}a.toplink:hover,a.toplink:active{text-decoration:none;background-color:transparent;opacity:.4;filter:alpha(opacity=40);background-position:bottom 7px right;background-size:contain}code span.co{font-style:normal}#nav{position:absolute;top:0;float:left;background-color:#084262;border:none}#nav ul{width:100%;list-style-type:none;text-align:center;color:#fff;font-size:.75em;letter-spacing:2px;font-weight:700;margin:0;padding:0}#nav ul li{display:inline}#nav ul li a,#nav ul li span{color:#fff;background-color:#084262;text-decoration:none;float:left;border-right:1px solid #7394B4;cursor:pointer;padding:.5em 11.5px}#nav ul li a:hover,#nav ul li span{color:#fff;background-color:#257B9D}@media print{#nav,#TOC,#TOC .toctitle,#TOC ul,#TOC ul ul,#TOC li{display:none}}</style>




</head>

<body>




<h1 class="title toc-ignore">replicateBE</h1>
<h3 class="subtitle">Comparative BA-calculation for the EMA’s Average Bioequivalence with Expanding Limits (ABEL)</h3>


<div id="TOC">
<ul>
<li><a href="#intro">Introduction</a></li>
<li><a href="#methods">Functions</a><ul>
<li><a href="#method.a"><code id="methodA">method.A()</code></a></li>
<li><a href="#method.b"><code id="methodB">method.B()</code></a></li>
<li><a href="#abe"><code id="ABE">ABE()</code></a></li>
</ul></li>
<li><a href="#hypotheses">Hypotheses</a></li>
<li><a href="#designs">Tested designs</a><ul>
<li><a href="#per4_full">Four period (full) replicates</a></li>
<li><a href="#per3_full">Three period (full) replicates</a></li>
<li><a href="#per2_full">Two period (full) replicate</a></li>
<li><a href="#per3_part">Three period (partial) replicates</a></li>
</ul></li>
<li><a href="#data_struct">Data structure</a><ul>
<li><a href="#fmt">Format</a></li>
<li><a href="#incomplete">Incomplete data</a></li>
</ul></li>
<li><a href="#notes">Notes on the methods</a><ul>
<li><a href="#cv">Estimation of intra-subject variability</a></li>
<li><a href="#model_struc">Model structure</a></li>
<li><a href="#BElim">BE limits, PE restriction, rounding issues</a></li>
<li><a href="#df_comp">Degrees of freedom, comparison of methods</a></li>
<li><a href="#ola">Outlier analysis</a></li>
</ul></li>
<li><a href="#app_out">Applicability, caveats, outlook</a></li>
<li><a href="#cross">Cross-validation</a></li>
<li><a href="#contr">Contributors</a></li>
<li><a href="#license">License</a></li>
<li><a href="#disclaimer">Disclaimer</a></li>
<li><a href="#session">Session Information</a></li>
</ul>
</div>

<div class="top">
<a class="toplink" href="#" title="▲ top"> </a>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(replicateBE) <span class="co"># attach the library</span></a></code></pre></div>
<p>Version 1.0.12.9001 built 2019-12-28 with R 3.6.2.<br />
</p>
<div id="intro" class="section level1">
<h1>Introduction</h1>
<p>The library provides datasets (internal <code>.rda</code> and in <span title="Comma Separated Variables">CSV</span>-format in <code>/extdata/</code>) which support users in a <a href="https://en.wikipedia.org/wiki/Black-box_testing">black-box</a> performance qualification (PQ) of their software installations.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Users can analyse own data imported from CSV- and Excel-files.</p>
<p>The methods given by the European Medicines Agency (EMA) in Annex I<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> for reference-scaling according to the Guideline on the Investigation of Bioequivalence<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> are implemented. Potential influence of outliers on the variability of the reference can be assessed by box plots of studentized and standardized residuals as suggested at a joint <span title="European Generic Medicines Association">EGA</span>/EMA symposium.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
</div>
<div id="methods" class="section level1">
<h1>Functions</h1>
<div id="method.a" class="section level2">
<h2><code id="methodA">method.A()</code></h2>
<p>A linear model of log-transformed PK responses and effects<br />
    <em>sequence</em>, <em>subject(sequence)</em>, <em>period</em>, <em>treatment</em><br />
where all effects are fixed (<em>i.e.</em>, ANOVA). Estimated via function <code>lm()</code> of library <code>stats</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">modA &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(PK) <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>subject<span class="op">%in%</span>sequence <span class="op">+</span><span class="st"> </span>period <span class="op">+</span><span class="st"> </span>treatment,</a>
<a class="sourceLine" id="cb2-2" title="2">                     <span class="dt">data =</span> data)</a></code></pre></div>
</div>
<div id="method.b" class="section level2">
<h2><code id="methodB">method.B()</code></h2>
<p>A linear model of log-transformed PK responses and effects<br />
    <em>sequence</em>, <em>subject(sequence)</em>, <em>period</em>, <em>treatment</em><br />
where <em>subject(sequence)</em> is a random effect and all others are fixed.<br />
</p>
<p>Three options are provided</p>
<ol style="list-style-type: decimal">
<li>Estimated via function <code>lmer()</code> of library <code>lmerTest</code>.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">modB &lt;-<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(PK) <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>period <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>subject),</a>
<a class="sourceLine" id="cb3-2" title="2">                       <span class="dt">data =</span> data)</a></code></pre></div>
<p>Employs Satterthwaite’s approximation<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> of the degrees of freedom <code>method.B(..., option = 1)</code> equivalent to SAS’ <code>DDFM=SATTERTHWAITE</code> and Phoenix WinNonlin’s <code>DF Satterthwaite</code>. Note that this is the only available approximation in SPSS.</p>
<ol start="2" style="list-style-type: decimal">
<li>Estimated via function <code>lme()</code> of library <code>nlme</code>.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">modB &lt;-<span class="st"> </span><span class="kw">lme</span>(<span class="kw">log</span>(PK) <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st">  </span>period <span class="op">+</span><span class="st"> </span>treatment, <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span><span class="op">|</span>subject,</a>
<a class="sourceLine" id="cb4-2" title="2">                      <span class="dt">data =</span> data)</a></code></pre></div>
<p>Employs degrees of freedom equivalent to SAS’ <code>DDFM=CONTAIN</code> and Phoenix WinNonlin’s <code>DF Residual</code>. Implicitly preferred according to the EMA’s Q&amp;A document. Hence, <code>method.B(..., option = 2)</code> is the default (<em>i.e.</em>, if the argument <code>option</code> is missing).</p>
<ol start="3" style="list-style-type: decimal">
<li>Estimated via function <code>lmer()</code> of library <code>lmerTest</code>.</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">modB &lt;-<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(PK) <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>period <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>subject),</a>
<a class="sourceLine" id="cb5-2" title="2">                       <span class="dt">data =</span> data)</a></code></pre></div>
<p>Employs the Kenward-Roger approximation<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> of the degrees of freedom <code>method.B(..., option = 3)</code> equivalent to SAS’ <code>DDFM=KENWARDROGER</code>. Note that this is the only available approximation in JMP.</p>
</div>
<div id="abe" class="section level2">
<h2><code id="ABE">ABE()</code></h2>
<p>Conventional Average Bioequivalence, where the model is identical to <a href="#methodA">Method A</a>. Tighter limits for narrow therapeutic index drugs (EMA 90.00 – 111.11%) or wider limits (75.00 – 133.33% for C<sub>max</sub> according to the guideline of the <span title="Gulf Cooperation Council: Bahrain, Kuwait, Oman, Qatar, Saudi Arabia, and the United Arab Emirates.">GCC</span>) can be specified by the arguments <code>theta1</code> (lower limit) and/or <code>theta2</code> (upper limit).</p>
</div>
</div>
<div id="hypotheses" class="section level1">
<h1>Hypotheses</h1>
<p>The hypotheses are <span class="math display">\[H_{0}:\theta_0\notin [L,U]\:vs\:H_{1}:L&lt;\theta_0&lt;U\]</span> where <small><span class="math inline">\(\theta_0=\mu_T/\mu_R\)</span></small> and the Null hypothesis is <u>in</u>equivalence. In Average Bioequivalence the limits <small><span class="math inline">\([L,U]\)</span></small> are fixed, whereas in ABEL they can be <a href="#BElim">expanded</a> based on the variability of the reference treatment.</p>
</div>
<div id="designs" class="section level1">
<h1>Tested designs</h1>
<p>Details about the reference datasets and their designs:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">help</span>(<span class="st">&quot;data&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;replicateBE&quot;</span>)</a>
<a class="sourceLine" id="cb6-2" title="2">?replicateBE<span class="op">::</span>data</a></code></pre></div>
<div id="per4_full" class="section level2">
<h2>Four period (full) replicates</h2>
<p>Both the test and the reference treatments are administered at least once.</p>
<div id="per4_full_2" class="section level3">
<h3>Two sequences</h3>
<p><code>TRTR | RTRT</code><br />
<code>TRRT | RTTR</code><br />
<code>TTRR | RRTT</code></p>
</div>
<div id="per4_full_4" class="section level3">
<h3>Four sequences</h3>
<p><code>TRTR | RTRT | TRRT | RTTR</code><br />
<code>TRRT | RTTR | TTRR | RRTT</code></p>
<p>Although supported, these design are <em>not recommended</em> due to confounded effects.</p>
</div>
</div>
<div id="per3_full" class="section level2">
<h2>Three period (full) replicates</h2>
<p>The test treatment is administered at least once to ½ of the subjects and the reference treatment at least once to the respective other ½ of the subjects.</p>
<p><code>TRT | RTR</code><br />
<code>TRR | RTT</code></p>
</div>
<div id="per2_full" class="section level2">
<h2>Two period (full) replicate</h2>
<p>The test and reference treatments are administered once to ½ of the subjects (for the estimation of the CI), <em>i.e.</em>, the first group of subjects follows a conventional 2×2×2 trial. In the second group the test and reference treatments are administered at least once to ¼ of the subjects, repectively (for the estimation of <em>CV<sub>wT</sub></em> and <em>CV<sub>wR</sub></em>).</p>
<p><code>TR | RT | TT | RR</code></p>
<p>Although supported, Balaam’s design<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a> is <em>not recommended</em> due to its poor power characteristics.</p>
</div>
<div id="per3_part" class="section level2">
<h2>Three period (partial) replicates</h2>
<p>The test treatment is administered once and the reference treatment at least once.</p>
<p><code>TRR | RTR | RRT</code><br />
<code>TRR | RTR</code></p>
<p>The latter is the so-called extra-reference design<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a> which is <em>not recommended</em> since it is biased in the presence of period effects.</p>
</div>
</div>
<div id="data_struct" class="section level1">
<h1>Data structure</h1>
<p>Columns must have the headers <code>subject</code>, <code>period</code>, <code>sequence</code>, <code>treatment</code>, <code>PK</code>, and/or <code>logPK</code>.<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a> Any order of columns is acceptable. Uppercase and mixed case headers will be internally converted to lowercase headers.</p>
<div id="fmt" class="section level2">
<h2>Format</h2>
<table>
<colgroup>
<col width="16%"></col>
<col width="83%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Format</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>subject</code></td>
<td>Integer numbers or any combination of alphanumerics (A-Z, a-z, -, _, #, 0-9)</td>
</tr>
<tr class="even">
<td><code>period</code></td>
<td>Integer numbers</td>
</tr>
<tr class="odd">
<td><code>sequence</code></td>
<td>Numbers or literal sequences not listed in the <a href="#designs">tested designs</a> are not accepted (<em>e.g.</em>, <strong><code>ABAB</code></strong>).</td>
</tr>
<tr class="even">
<td><code>treatment</code></td>
<td>The Test treatment must be coded <strong><code>T</code></strong> and the Reference <strong><code>R</code></strong> (both uppercase).</td>
</tr>
<tr class="odd">
<td><code>PK</code></td>
<td>Real <span title="zero is not acceptable">positive</span> numbers of PK responses.</td>
</tr>
<tr class="even">
<td><code>logPK</code></td>
<td>Real numbers of already log<sub>e</sub>-transformed PK responses (optional and rarely needed).</td>
</tr>
</tbody>
</table>
<p>Relevant data are used for the estimation of <em>CV<sub>wR</sub></em> (and <em>CV<sub>wT</sub></em> in full replicate designs) and BE, <em>i.e.</em>, the data­sets might be different (see the <a href="#setexpl">example below</a>). It is good practice to state that in the Statistical Analysis Plan (SAP).</p>
</div>
<div id="incomplete" class="section level2">
<h2>Incomplete data</h2>
<div id="setCW" class="section level3">
<h3>Estimation of <em>CV<sub>w</sub></em></h3>
<p>If a subject drops out from the study in a higher period, data of repeated administrations will still be used for the estimation of <em>CV<sub>w</sub></em>, although data of the other treatment might be missing. Examples for the estimation of <em>CV<sub>wR</sub></em> (missings denoted by <code>.</code>):<br />
</p>
<p><code>RTRT</code> | <code>RTR.</code><br />
<code>TRRT</code> | <code>TRR.</code><br />
<code>RRTT</code> | <code>RRT.</code> or <code>RR..</code><br />
<code>RRT</code> | <code>RR..</code><br />
</p>
</div>
<div id="setBE" class="section level3">
<h3>Assessment of BE</h3>
<p>If a subject drops out from the study in a higher period, data with at least one administration of the Test and Reference will be used in the assessment of BE. Examples (missings denoted by <code>.</code>):<br />
</p>
<p><code>TRTR</code> | <code>TRT.</code> or | <code>TR..</code><br />
<code>RTRT</code> | <code>RTR.</code> or | <code>RT..</code><br />
<code>TRRT</code> | <code>TRR.</code> or | <code>TR..</code><br />
<code>RTTR</code> | <code>RTT.</code> or | <code>RT..</code><br />
<code>TTRR</code> | <code>TTR.</code><br />
<code>TRT</code> | <code>TR.</code><br />
<code>RTR</code> | <code>RT.</code><br />
<code>TRR</code> | <code>TR.</code><br />
<code>RTR</code> | <code>RT.</code><br />
<code>RTT</code> | <code>RT.</code><br />
</p>
</div>
<div id="setexpl" class="section level3">
<h3>Example of different datasets</h3>
<p>16 subjects enrolled in the study. In sequence <code>RTRT</code> one dropout in the 2<sup>nd</sup> period and one in the 4<sup>th</sup> period. In sequence <code>TRTR</code> one dropout in the 3<sup>rd</sup> period and one in the 4<sup>th</sup>.<br />
</p>
<p><code>1  RTR.    5  RTRT    9  TRTR   13  RTRT</code><br />
<code>2  RTRT    6  TR..   10  TRTR   14  TRT.</code><br />
<code>3  RTRT    7  RTRT   11  RTRT   15  TRTR</code><br />
<code>4  TRTR    8  R...   12  TRTR   16  TRTR</code></p>
<p>We obtain these datasets:</p>
<table>
<thead>
<tr class="header">
<th align="center">Dataset</th>
<th>Purpose</th>
<th>included</th>
<th align="center">excluded</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">#1</td>
<td>Estimation of <em>CV<sub>wR</sub></em></td>
<td>13 who received 2 treatments <code>R</code></td>
<td align="center">6, 8, 14</td>
</tr>
<tr class="even">
<td align="center">#2</td>
<td>Estimation of <em>CV<sub>wT</sub></em></td>
<td>12 who received 2 treatments <code>T</code></td>
<td align="center">1, 6, 8</td>
</tr>
<tr class="odd">
<td align="center">#3</td>
<td>Assessment of BE</td>
<td>15 who received ≥1 treatment <code>T</code> <em>and</em> ≥1 treatment <code>R</code></td>
<td align="center">8</td>
</tr>
</tbody>
</table>
<p>Datasets #1 and #3 are required for ABEL and all three for the WHO’s reference-scaling of AUC (see <a href="#app_out">below</a>). For ABE only dataset #3 is required.</p>
</div>
</div>
</div>
<div id="notes" class="section level1">
<h1>Notes on the methods</h1>
<div id="cv" class="section level2">
<h2>Estimation of intra-subject variability</h2>
<p>The EMA proposed a linear model of log-transformed PK responses of the reference treatment<br />
    <em>sequence</em>, <em>subject(sequence)</em>, <em>period</em><br />
where all effects are fixed. Estimated via function <code>lm()</code> of library <code>stats</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">modCV &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(PK) <span class="op">~</span><span class="st"> </span>sequence <span class="op">+</span><span class="st"> </span>subject<span class="op">%in%</span>sequence <span class="op">+</span><span class="st"> </span>period,</a>
<a class="sourceLine" id="cb7-2" title="2">                      <span class="dt">data =</span> data[data<span class="op">$</span><span class="dt">treatment =</span> <span class="st">&quot;R&quot;</span>, ])</a></code></pre></div>
<p>For informational purposes in full replicate designs (required by the WHO for reference-scaling of AUC; see <a href="#app_out">below</a>) the same model is run with <code>data = data[data$treatment = &quot;T&quot;, ]</code>.</p>
<p>Special conditions for the sample size in three period full replicate designs:</p>
<blockquote>
<p><em>The question raised asks if it is possible to use a design where subjects are randomised to receive treatments in the order of TRT or RTR.</em></p>
<p><em>The CHMP bioequivalence guideline requires that at least 12 patients are needed to provide data for a bioequivalence study to be considered valid, and to estimate all the key parameters. Therefore, if a 3-period replicate design, where treatments are given in the order TRT or RTR, is to be used to justify widening of a confidence interval for C<sub>max</sub> then it is considered that at least 12 patients would need to provide data from the RTR arm. This implies a study with at least 24 patients in total would be required if equal number of subjects are allocated to the 2 treatment sequences.</em></p>
<p>— Q&amp;A document<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a></p>
</blockquote>
<p>If less than twelve subjects remain in sequence <code>RTR</code> of a <code>TRT | RTR</code> design (and in analogy in sequence <code>TRR</code> of a <code>TRR | RTT</code> design), the user is notified about the ‘uncertain’ estimate of <em>CV<sub>wR</sub></em>. However, in a sufficiently powered study such a case is <a href="https://forum.bebac.at/forum_entry.php?id=15139" title="BEBA Forum, 23 July 2015">extremely unlikely</a>. Let us explore the confidence interval of the <em>CV</em>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># Estimate sample sizes of full replicate designs (theta0 0.90, target</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co"># power 0.80) and CI of the CV with library PowerTOST</span></a>
<a class="sourceLine" id="cb8-3" title="3">CV &lt;-<span class="st"> </span><span class="fl">0.30</span></a>
<a class="sourceLine" id="cb8-4" title="4">n4 &lt;-<span class="st"> </span>PowerTOST<span class="op">::</span><span class="kw">sampleN.scABEL</span>(<span class="dt">CV =</span> CV, <span class="dt">design =</span> <span class="st">&quot;2x2x4&quot;</span>, <span class="dt">details =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb8-5" title="5">                                <span class="dt">print =</span> <span class="ot">FALSE</span>)[[<span class="st">&quot;Sample size&quot;</span>]] <span class="co"># 4-period</span></a>
<a class="sourceLine" id="cb8-6" title="6">n3 &lt;-<span class="st"> </span>PowerTOST<span class="op">::</span><span class="kw">sampleN.scABEL</span>(<span class="dt">CV =</span> CV, <span class="dt">design =</span> <span class="st">&quot;2x2x3&quot;</span>, <span class="dt">details =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb8-7" title="7">                                <span class="dt">print =</span> <span class="ot">FALSE</span>)[[<span class="st">&quot;Sample size&quot;</span>]] <span class="co"># 3-period</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co"># 95% CI of CVs in %</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span>PowerTOST<span class="op">::</span><span class="kw">CVCL</span>(<span class="dt">CV =</span> CV, <span class="dt">df =</span> <span class="dv">3</span><span class="op">*</span>n4<span class="dv">-4</span>, <span class="st">&quot;2-sided&quot;</span>), <span class="dv">2</span>) <span class="co"># 4-period</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co"># lower CL upper CL </span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">#    26.19    35.15</span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span>PowerTOST<span class="op">::</span><span class="kw">CVCL</span>(<span class="dt">CV =</span> CV, <span class="dt">df =</span> <span class="dv">2</span><span class="op">*</span>n3<span class="dv">-3</span>, <span class="st">&quot;2-sided&quot;</span>), <span class="dv">2</span>) <span class="co"># 3-period</span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co"># lower CL upper CL </span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co">#    26.18    35.18</span></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="co"># As above but assume that only 12 subjects remain in each sequence</span></a>
<a class="sourceLine" id="cb8-16" title="16"><span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span>PowerTOST<span class="op">::</span><span class="kw">CVCL</span>(<span class="dt">CV =</span> CV, <span class="dt">df =</span> <span class="dv">3</span><span class="op">*</span><span class="dv">24-4</span>, <span class="st">&quot;2-sided&quot;</span>), <span class="dv">2</span>) <span class="co"># 4-period</span></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="co"># lower CL upper CL </span></a>
<a class="sourceLine" id="cb8-18" title="18"><span class="co">#    25.55    36.40</span></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span>PowerTOST<span class="op">::</span><span class="kw">CVCL</span>(<span class="dt">CV =</span> CV, <span class="dt">df =</span> <span class="dv">2</span><span class="op">*</span><span class="dv">24-3</span>, <span class="st">&quot;2-sided&quot;</span>), <span class="dv">2</span>) <span class="co"># 3-period</span></a>
<a class="sourceLine" id="cb8-20" title="20"><span class="co"># lower CL upper CL </span></a>
<a class="sourceLine" id="cb8-21" title="21"><span class="co">#    24.71    38.28</span></a></code></pre></div>
<p>It is unclear why the four period replicate is considered by the EMA to give a more ‘reliable’ estimate than the three period replicate.</p>
</div>
<div id="model_struc" class="section level2">
<h2>Model structure</h2>
<p>The EMA’s models assumes equal [<em>sic</em>] intra-subject variances of Test and Reference (like in 2×2×2 trials) – even if proven false in one of the full replicate designs (were <em>both</em> <em>CV<sub>wT</sub></em> and <em>CV<sub>wR</sub></em> can be estimated). Hence, amongst biostatisticians they are called ‘crippled models’ because the replicative nature of the study is ignored.</p>
<p>The nested structure <em>subject(sequence)</em> of the <a href="#methods">methods</a> leads to an over-specificed model.<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a> The simple model<br />
    <em>sequence</em>, <em>subject</em>, <em>period</em>, <em>treatment</em><br />
gives identical estimates of the residual variance and the treatment effect and hence, its confidence interval.</p>
<p>The same holds true for the <a href="#cv">EMA’s model</a> to estimate <em>CV<sub>wR</sub></em>. The simple model<br />
    <em>subject</em>, <em>period</em><br />
gives an identical estimate of the residual variance.</p>
<p>Reference-scaling is acceptable for C<sub>max</sub> (immediate release products: BE-Guideline) and C<sub>max</sub>, C<sub>max,ss</sub>, C<sub>τ,ss</sub>, <sub>partial</sub>AUC (modified release products<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a>). The intention to widen the limits has to be stated in the protocol and – contrary to the FDA’s <span title="Reference Scaled Average Bioequivalence">RSABE</span> – a clinical justification provided.</p>
<blockquote>
<p><em>Those HVDP for which a wider difference in C<sub>max</sub> is considered clinically irrelevant based on a sound clinical justification can be assessed with a widened acceptance range. The request for widened interval must be prospectively specified in the protocol.</em></p>
<p>— BE Guideline</p>
</blockquote>
</div>
<div id="BElim" class="section level2">
<h2>BE limits, PE restriction, rounding issues</h2>
<p>The limits can be expanded based on <em>CV<sub>wR</sub></em>.</p>
<ul>
<li><em>CV<sub>wR</sub></em> ≤ 30%<br />
Lower cap, <em>i.e.</em>, no scaling, conventional limits:<br />
<small><span class="math inline">\(\left[ {L,U} \right] = {80.00 - 125.00\%}\)</span></small></li>
<li>30% &lt; <em>CV<sub>wR</sub></em> ≤ 50%<br />
Expanded limits based on <span class="math inline">\(s_{wR}\)</span>:<br />
<small><span class="math inline">\(\left[ {L,U} \right] = 100{e^{ \mp 0.760 \cdot {s_{wR}}}}\)</span></small></li>
<li><em>CV<sub>wR</sub></em> &gt; 50%<br />
Upper cap, <em>i.e.</em>, applying <small><span class="math inline">\(s^*_{wR}=\sqrt{log(0.50^2+1)}\)</span></small> in the expansion formula or<br />
<small><span class="math inline">\(\left[ {L,U} \right] = {69.84 - 143.19\%}\)</span></small>.</li>
</ul>
<p>In reference-scaling a so-called <em>mixed</em> (a.k.a. <em>aggregate</em>) criterion is applied. In order to pass BE,</p>
<ul>
<li>the 90% confidence interval has to lie entirely within the acceptance range <small><span class="math inline">\(\left[ {L,U} \right]\)</span></small> <em>and</em></li>
<li>the point estimate has to lie within 80.00 – 125.00%.</li>
</ul>
<p>To avoid discontinuities due to double rounding, expanded limits are calculated in full numeric precision and only the confidence interval is rounded according to the guideline.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># Calculate limits with library PowerTOST</span></a>
<a class="sourceLine" id="cb9-2" title="2">CV &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">40</span>, <span class="fl">49.6</span>, <span class="dv">50</span>, <span class="fl">50.4</span>)</a>
<a class="sourceLine" id="cb9-3" title="3">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">CV =</span> CV, <span class="dt">L =</span> <span class="ot">NA</span>, <span class="dt">U =</span> <span class="ot">NA</span>, <span class="dt">cap =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb9-4" title="4">                 <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb9-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(CV)) {</a>
<a class="sourceLine" id="cb9-6" title="6">  df[i, <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&quot;%.8f&quot;</span>, PowerTOST<span class="op">::</span><span class="kw">scABEL</span>(CV[i]<span class="op">/</span><span class="dv">100</span>)<span class="op">*</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb9-7" title="7">}</a>
<a class="sourceLine" id="cb9-8" title="8">df<span class="op">$</span>cap[df<span class="op">$</span>CV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">30</span>] &lt;-<span class="st"> &quot;lower&quot;</span></a>
<a class="sourceLine" id="cb9-9" title="9">df<span class="op">$</span>cap[df<span class="op">$</span>CV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">50</span>] &lt;-<span class="st"> &quot;upper&quot;</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="kw">names</span>(df)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;CV(%)&quot;</span>, <span class="st">&quot;L(%)&quot;</span>, <span class="st">&quot;U(%)&quot;</span>)</a>
<a class="sourceLine" id="cb9-11" title="11"><span class="kw">print</span>(df, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">#  CV(%)        L(%)         U(%)   cap</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co">#   30.0 80.00000000 125.00000000 lower</span></a>
<a class="sourceLine" id="cb9-14" title="14"><span class="co">#   40.0 74.61770240 134.01645559      </span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="co">#   49.6 70.01700049 142.82245641      </span></a>
<a class="sourceLine" id="cb9-16" title="16"><span class="co">#   50.0 69.83678198 143.19101936 upper</span></a>
<a class="sourceLine" id="cb9-17" title="17"><span class="co">#   50.4 69.83678198 143.19101936 upper</span></a></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Discrete limits resulting from rounding" style="width:80.0%" />
<p class="caption">Discrete limits resulting from rounding</p>
</div>
</div>
<div id="df_comp" class="section level2">
<h2>Degrees of freedom, comparison of methods</h2>
<p>The SAS code provided by the EMA in the Q&amp;A document does not specify how the degrees of freedom should be calculated in ‘Method B’. Hence, the default in <code>PROC MIXED</code>, namely <code>DDFM=CONTAIN</code> is applied, <em>i.e.</em>, <code>method.B(..., option = 2</code>). For incomplete data (missing periods) Satterthwaite’s approximation of the degrees of freedom, <em>i.e.</em>, <code>method.B(..., option = 1)</code> or Kenward-Roger <code>method.B(..., option = 3)</code> might be a better choice – if stated as such in the SAP.</p>
<p>The EMA seemingly prefers ‘Method A’:</p>
<blockquote>
<p><em>A simple linear mixed model, which assumes identical within-subject variability (Method B), may be acceptable as long as results obtained with the two methods do not lead to different regulatory decisions. However, in borderline cases […] additional analysis using Method A might be required.</em></p>
<p>— Q&amp;A document (January 2011 and later revisions)</p>
</blockquote>
<p>The half-width of the confidence interval in log-scale allows a comparison of methods (B <em>v.s.</em> A) where a higher value <em>might</em> point towards a more conservative decision.<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a> In the provided example datasets – with one exception – the conclusion of BE (based on the mixed criterion) agrees between ‘Method A’ and ‘Method B’.<br />
However, for the highly incomplete dataset 14 ‘Method A’ was <em>liberal</em> (passing by ANOVA but failing by the random effects model):</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># Compare Method B acc. to the GL with Method A for all reference datasets.</span></a>
<a class="sourceLine" id="cb10-2" title="2">ds &lt;-<span class="st"> </span><span class="kw">substr</span>(<span class="kw">grep</span>(<span class="st">&quot;rds&quot;</span>, <span class="kw">unname</span>(<span class="kw">unlist</span>(<span class="kw">data</span>(<span class="dt">package =</span> <span class="st">&quot;replicateBE&quot;</span>))),</a>
<a class="sourceLine" id="cb10-3" title="3">                  <span class="dt">value =</span> <span class="ot">TRUE</span>), <span class="dt">start =</span> <span class="dv">1</span>, <span class="dt">stop =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb10-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(ds)) {</a>
<a class="sourceLine" id="cb10-5" title="5">  A &lt;-<span class="st"> </span><span class="kw">method.A</span>(<span class="dt">print =</span> <span class="ot">FALSE</span>, <span class="dt">details =</span> <span class="ot">TRUE</span>, <span class="dt">data =</span> <span class="kw">eval</span>(<span class="kw">parse</span>(<span class="dt">text =</span> ds[i])))<span class="op">$</span>BE</a>
<a class="sourceLine" id="cb10-6" title="6">  B &lt;-<span class="st"> </span><span class="kw">method.B</span>(<span class="dt">print =</span> <span class="ot">FALSE</span>, <span class="dt">details =</span> <span class="ot">TRUE</span>, <span class="dt">data =</span> <span class="kw">eval</span>(<span class="kw">parse</span>(<span class="dt">text =</span> ds[i])))<span class="op">$</span>BE</a>
<a class="sourceLine" id="cb10-7" title="7">  r &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;A &quot;</span>, A, <span class="st">&quot;, B &quot;</span>, B, <span class="st">&quot; \u2013 &quot;</span>)</a>
<a class="sourceLine" id="cb10-8" title="8">  <span class="kw">cat</span>(<span class="kw">paste0</span>(ds[i], <span class="st">&quot;:&quot;</span>), r)</a>
<a class="sourceLine" id="cb10-9" title="9">  <span class="cf">if</span> (A <span class="op">==</span><span class="st"> </span>B) {</a>
<a class="sourceLine" id="cb10-10" title="10">    <span class="kw">cat</span>(<span class="st">&quot;Methods agree.</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb10-11" title="11">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb10-12" title="12">    <span class="cf">if</span> (A <span class="op">==</span><span class="st"> &quot;fail&quot;</span> <span class="op">&amp;</span><span class="st"> </span>B <span class="op">==</span><span class="st"> &quot;pass&quot;</span>) {</a>
<a class="sourceLine" id="cb10-13" title="13">      <span class="kw">cat</span>(<span class="st">&quot;Method A is conservative.</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb10-14" title="14">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb10-15" title="15">      <span class="kw">cat</span>(<span class="st">&quot;Method B is conservative.</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb10-16" title="16">    }</a>
<a class="sourceLine" id="cb10-17" title="17">  }</a>
<a class="sourceLine" id="cb10-18" title="18">}</a>
<a class="sourceLine" id="cb10-19" title="19"><span class="co"># rds01: A pass, B pass – Methods agree.</span></a>
<a class="sourceLine" id="cb10-20" title="20"><span class="co"># rds02: A pass, B pass – Methods agree.</span></a>
<a class="sourceLine" id="cb10-21" title="21"><span class="co"># rds03: A pass, B pass – Methods agree.</span></a>
<a class="sourceLine" id="cb10-22" title="22"><span class="co"># rds04: A fail, B fail – Methods agree.</span></a>
<a class="sourceLine" id="cb10-23" title="23"><span class="co"># rds05: A pass, B pass – Methods agree.</span></a>
<a class="sourceLine" id="cb10-24" title="24"><span class="co"># rds06: A pass, B pass – Methods agree.</span></a>
<a class="sourceLine" id="cb10-25" title="25"><span class="co"># rds07: A pass, B pass – Methods agree.</span></a>
<a class="sourceLine" id="cb10-26" title="26"><span class="co"># rds08: A pass, B pass – Methods agree.</span></a>
<a class="sourceLine" id="cb10-27" title="27"><span class="co"># rds09: A pass, B pass – Methods agree.</span></a>
<a class="sourceLine" id="cb10-28" title="28"><span class="co"># rds10: A pass, B pass – Methods agree.</span></a>
<a class="sourceLine" id="cb10-29" title="29"><span class="co"># rds11: A pass, B pass – Methods agree.</span></a>
<a class="sourceLine" id="cb10-30" title="30"><span class="co"># rds12: A fail, B fail – Methods agree.</span></a>
<a class="sourceLine" id="cb10-31" title="31"><span class="co"># rds13: A fail, B fail – Methods agree.</span></a>
<a class="sourceLine" id="cb10-32" title="32"><span class="co"># rds14: A pass, B fail – Method B is conservative.</span></a>
<a class="sourceLine" id="cb10-33" title="33"><span class="co"># rds15: A fail, B fail – Methods agree.</span></a>
<a class="sourceLine" id="cb10-34" title="34"><span class="co"># rds16: A fail, B fail – Methods agree.</span></a>
<a class="sourceLine" id="cb10-35" title="35"><span class="co"># rds17: A fail, B fail – Methods agree.</span></a>
<a class="sourceLine" id="cb10-36" title="36"><span class="co"># rds18: A fail, B fail – Methods agree.</span></a>
<a class="sourceLine" id="cb10-37" title="37"><span class="co"># rds19: A fail, B fail – Methods agree.</span></a>
<a class="sourceLine" id="cb10-38" title="38"><span class="co"># rds20: A fail, B fail – Methods agree.</span></a>
<a class="sourceLine" id="cb10-39" title="39"><span class="co"># rds21: A fail, B fail – Methods agree.</span></a>
<a class="sourceLine" id="cb10-40" title="40"><span class="co"># rds22: A pass, B pass – Methods agree.</span></a>
<a class="sourceLine" id="cb10-41" title="41"><span class="co"># rds23: A pass, B pass – Methods agree.</span></a>
<a class="sourceLine" id="cb10-42" title="42"><span class="co"># rds24: A pass, B pass – Methods agree.</span></a>
<a class="sourceLine" id="cb10-43" title="43"><span class="co"># rds25: A pass, B pass – Methods agree.</span></a>
<a class="sourceLine" id="cb10-44" title="44"><span class="co"># rds26: A fail, B fail – Methods agree.</span></a>
<a class="sourceLine" id="cb10-45" title="45"><span class="co"># rds27: A pass, B pass – Methods agree.</span></a>
<a class="sourceLine" id="cb10-46" title="46"><span class="co"># rds28: A pass, B pass – Methods agree.</span></a>
<a class="sourceLine" id="cb10-47" title="47"><span class="co"># rds29: A pass, B pass – Methods agree.</span></a>
<a class="sourceLine" id="cb10-48" title="48"><span class="co"># rds30: A fail, B fail – Methods agree.</span></a></code></pre></div>
<p>Exploring dataset 14:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">A  &lt;-<span class="st"> </span><span class="kw">method.A</span>(<span class="dt">print =</span> <span class="ot">FALSE</span>, <span class="dt">details =</span> <span class="ot">TRUE</span>, <span class="dt">data =</span> rds14)</a>
<a class="sourceLine" id="cb11-2" title="2">B1 &lt;-<span class="st"> </span><span class="kw">method.B</span>(<span class="dt">print =</span> <span class="ot">FALSE</span>, <span class="dt">details =</span> <span class="ot">TRUE</span>, <span class="dt">data =</span> rds14, <span class="dt">option =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-3" title="3">B2 &lt;-<span class="st"> </span><span class="kw">method.B</span>(<span class="dt">print =</span> <span class="ot">FALSE</span>, <span class="dt">details =</span> <span class="ot">TRUE</span>, <span class="dt">data =</span> rds14) <span class="co"># apply default option</span></a>
<a class="sourceLine" id="cb11-4" title="4">B3 &lt;-<span class="st"> </span><span class="kw">method.B</span>(<span class="dt">print =</span> <span class="ot">FALSE</span>, <span class="dt">details =</span> <span class="ot">TRUE</span>, <span class="dt">data =</span> rds14, <span class="dt">option =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co"># Rounding of CI according to the GL</span></a>
<a class="sourceLine" id="cb11-6" title="6">A[<span class="dv">15</span><span class="op">:</span><span class="dv">19</span>]  &lt;-<span class="st"> </span><span class="kw">round</span>(A[<span class="dv">15</span><span class="op">:</span><span class="dv">19</span>],  <span class="dv">2</span>) <span class="co"># all effects fixed</span></a>
<a class="sourceLine" id="cb11-7" title="7">B1[<span class="dv">15</span><span class="op">:</span><span class="dv">19</span>] &lt;-<span class="st"> </span><span class="kw">round</span>(B1[<span class="dv">15</span><span class="op">:</span><span class="dv">19</span>], <span class="dv">2</span>) <span class="co"># Satterthwaite&#39;s df</span></a>
<a class="sourceLine" id="cb11-8" title="8">B2[<span class="dv">15</span><span class="op">:</span><span class="dv">19</span>] &lt;-<span class="st"> </span><span class="kw">round</span>(B2[<span class="dv">15</span><span class="op">:</span><span class="dv">19</span>], <span class="dv">2</span>) <span class="co"># df acc. to Q&amp;A</span></a>
<a class="sourceLine" id="cb11-9" title="9">B3[<span class="dv">15</span><span class="op">:</span><span class="dv">19</span>] &lt;-<span class="st"> </span><span class="kw">round</span>(B3[<span class="dv">15</span><span class="op">:</span><span class="dv">19</span>], <span class="dv">2</span>) <span class="co"># Kenward-Roger df</span></a>
<a class="sourceLine" id="cb11-10" title="10">cs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>)</a>
<a class="sourceLine" id="cb11-11" title="11">df &lt;-<span class="st"> </span><span class="kw">rbind</span>(A[cs], B1[cs], B2[cs], B3[cs])</a>
<a class="sourceLine" id="cb11-12" title="12"><span class="kw">names</span>(df)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">11</span>)] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Meth.&quot;</span>, <span class="st">&quot;L(%)&quot;</span>, <span class="st">&quot;U(%)&quot;</span>,</a>
<a class="sourceLine" id="cb11-13" title="13">                              <span class="st">&quot;CL.lo(%)&quot;</span>, <span class="st">&quot;CL.hi(%)&quot;</span>, <span class="st">&quot;hw&quot;</span>)</a>
<a class="sourceLine" id="cb11-14" title="14">df[, <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">11</span>)] &lt;-<span class="st"> </span><span class="kw">signif</span>(df[, <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">11</span>)], <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb11-15" title="15"><span class="kw">print</span>(df[<span class="kw">order</span>(df<span class="op">$</span>BE, df<span class="op">$</span>hw, <span class="dt">decreasing =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>)), ],</a>
<a class="sourceLine" id="cb11-16" title="16">      <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb11-17" title="17"><span class="co">#  Meth.     DF  L(%)   U(%) CL.lo(%) CL.hi(%) PE(%)   CI  GMR   BE      hw</span></a>
<a class="sourceLine" id="cb11-18" title="18"><span class="co">#    B-1 197.44 69.84 143.19    69.21   121.27 91.62 fail pass fail 0.28043</span></a>
<a class="sourceLine" id="cb11-19" title="19"><span class="co">#    B-2 192.00 69.84 143.19    69.21   121.28 91.62 fail pass fail 0.28046</span></a>
<a class="sourceLine" id="cb11-20" title="20"><span class="co">#    B-3 195.99 69.84 143.19    69.21   121.28 91.62 fail pass fail 0.28052</span></a>
<a class="sourceLine" id="cb11-21" title="21"><span class="co">#      A 192.00 69.84 143.19    69.99   123.17 92.85 pass pass pass 0.28261</span></a></code></pre></div>
<p>All variants of ‘Method B’ are more conservative than ‘Method A’. Before rounding the confidence interval, <code>option = 2</code> with 192 degrees of freedom would be more conservative (lower CL 69.21029) than <code>option = 1</code> with 197.44 degrees of freedom (lower CL 69.21286). Given the incompleteness of this dataset (four missings in period 2, twelve in period 3, and 19 in period 4), Satterthwaite’s or Kenward-Roger degrees of freedom are probably the better choice.</p>
</div>
<div id="ola" class="section level2">
<h2>Outlier analysis</h2>
<p>It is an open issue how outliers should be handled.</p>
<blockquote>
<p><em>The applicant should justify that the calculated intra-subject variability is a reliable estimate and that it is not the result of outliers.</em></p>
<p>— BE-Guideline</p>
</blockquote>
<p>Box plots were ‘suggested’ by the author as a mere joke [<em>sic</em>] at the EGA/EMA symposium, being aware of their non­para­metric nature and the EMA’s reluctance towards robust methods. Alas, this <em>joke</em> was included in the Q&amp;A document.</p>
<blockquote>
<p><em>[…] a study could be acceptable if the bioequivalence requirements are met both including the outlier subject (using the scaled average bioequivalence approach and the within-subject CV with this subject) and after exclusion of the outlier (using the within-subject CV without this subject).</em></p>
<p><em>An outlier test is not an expectation of the medicines agencies but outliers could be shown by a box plot. This would allow the medicines agencies to compare the data between them.</em></p>
<p>— EGA/EMA Q&amp;A-document</p>
</blockquote>
<p>With the additional argument <code>ola = TRUE</code> in <code>method.A()</code> and <code>method.B()</code> an outlier analysis is performed, where the default <code>fence = 2</code>.<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a></p>
<p>Results differ slightly depending on software’s algorithms to calculate the median and quartiles. Example with the ‘types’ implemented in R (note the differences even in the medians):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co">### Compare different types with some random data</span></a>
<a class="sourceLine" id="cb12-2" title="2">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">48</span>)</a>
<a class="sourceLine" id="cb12-3" title="3">p &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>)<span class="op">/</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb12-4" title="4">q &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="st">&quot;&quot;</span>, <span class="dt">nrow =</span> <span class="dv">9</span>, <span class="dt">ncol =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb12-5" title="5">            <span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="kw">paste</span>(<span class="st">&quot;type =&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>),</a>
<a class="sourceLine" id="cb12-6" title="6">                            <span class="kw">c</span>(<span class="st">&quot;1st quart.&quot;</span>, <span class="st">&quot;median&quot;</span>, <span class="st">&quot;3rd quart.&quot;</span>,</a>
<a class="sourceLine" id="cb12-7" title="7">                              <span class="st">&quot;software / default&quot;</span>)))</a>
<a class="sourceLine" id="cb12-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>) {</a>
<a class="sourceLine" id="cb12-9" title="9">  q[i, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&quot;%.5f&quot;</span>, <span class="kw">quantile</span>(x, <span class="dt">prob =</span> p, <span class="dt">type =</span> i))</a>
<a class="sourceLine" id="cb12-10" title="10">}</a>
<a class="sourceLine" id="cb12-11" title="11">q[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span><span class="op">:</span><span class="dv">8</span>), <span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;SAS, Stata&quot;</span>, <span class="st">&quot;SciPy&quot;</span>, <span class="st">&quot;Phoenix, Minitab, SPSS&quot;</span>,</a>
<a class="sourceLine" id="cb12-12" title="12">                        <span class="st">&quot;R, S, MATLAB, Octave, Excel&quot;</span>, <span class="st">&quot;Maple&quot;</span>)</a>
<a class="sourceLine" id="cb12-13" title="13"><span class="kw">print</span>(<span class="kw">as.data.frame</span>(q))</a>
<a class="sourceLine" id="cb12-14" title="14"><span class="co">#          1st quart.   median 3rd quart.          software / default</span></a>
<a class="sourceLine" id="cb12-15" title="15"><span class="co"># type = 1   -0.86817 -0.40487    0.29546                            </span></a>
<a class="sourceLine" id="cb12-16" title="16"><span class="co"># type = 2   -0.85617 -0.38854    0.30042                  SAS, Stata</span></a>
<a class="sourceLine" id="cb12-17" title="17"><span class="co"># type = 3   -0.86817 -0.40487    0.29546                            </span></a>
<a class="sourceLine" id="cb12-18" title="18"><span class="co"># type = 4   -0.86817 -0.40487    0.29546                       SciPy</span></a>
<a class="sourceLine" id="cb12-19" title="19"><span class="co"># type = 5   -0.85617 -0.38854    0.30042                            </span></a>
<a class="sourceLine" id="cb12-20" title="20"><span class="co"># type = 6   -0.86217 -0.38854    0.30290      Phoenix, Minitab, SPSS</span></a>
<a class="sourceLine" id="cb12-21" title="21"><span class="co"># type = 7   -0.85017 -0.38854    0.29794 R, S, MATLAB, Octave, Excel</span></a>
<a class="sourceLine" id="cb12-22" title="22"><span class="co"># type = 8   -0.85817 -0.38854    0.30124                       Maple</span></a>
<a class="sourceLine" id="cb12-23" title="23"><span class="co"># type = 9   -0.85767 -0.38854    0.30104</span></a></code></pre></div>
<ul>
<li>Box plots of studentized<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a> and standarized<a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a> model residuals are constructed.<a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a></li>
<li>Potential outliers are flagged based on the argument <code>fence</code> provided by the user.</li>
<li>With the additional argument <code>verbose = TRUE</code> detailed information is shown in the console.</li>
</ul>
<p>Example for the reference dataset 01:</p>
<pre><code>Outlier analysis
 (externally) studentized residuals
 Limits (2×IQR whiskers): -1.717435, 1.877877
 Outliers:
 subject sequence  stud.res
      45     RTRT -6.656940
      52     RTRT  3.453122

 standarized (internally studentized) residuals
 Limits (2×IQR whiskers): -1.69433, 1.845333
 Outliers:
 subject sequence stand.res
      45     RTRT -5.246293
      52     RTRT  3.214663</code></pre>
<p>If based on <em>studentized</em> residuals outliers are detected, additionally to the expanded limits based on the complete reference data, tighter limits are calculated based on <em>CV<sub>wR</sub></em> after exclusion of outliers and BE assessed with the new limits. Note that <em>standardized</em> residuals are given for informational purposes only and are not used for exclusion of outliers.</p>
<p>Output for the reference dataset 01 (re-ordered for clarity):</p>
<pre><code>CVwR               :  46.96% (reference-scaling applicable)
swR                :   0.44645
Expanded limits    :  71.23% ... 140.40% [100exp(±0.760Â·swR)]
Assessment based on original CVwR 46.96%
────────────────────────────────────────
Confidence interval: 107.11% ... 124.89%  pass
Point estimate     : 115.66%              pass
Mixed (CI &amp; PE)    :                      pass
 ╟────────┼─────────────────────┼───────■────────◊─────────■───────────────╢

Outlier fence      :  2×IQR of studentized residuals.
Recalculation due to presence of 2 outliers (subj. 45|52)
─────────────────────────────────────────────────────────
CVwR (outl. excl.) :  32.16% (reference-scaling applicable)
swR (recalculated) :   0.31374
Expanded limits    :  78.79% ... 126.93% [100exp(±0.760·swR)]
Assessment based on recalculated CVwR 32.16%
────────────────────────────────────────────
Confidence interval: pass
Point estimate     : pass
Mixed (CI &amp; PE)    : pass
         ╟┼─────────────────────┼───────■────────◊─────────■─╢</code></pre>
<p>Note that the PE and its CI are not affected since the entire data are used and therefore, these values not reported in the second analysis (only the conclusion of the assessement).<br />
The ‘line plot’ is given for informational purposes since its resolution is only ~0.5%. The filled squares <code>■</code> are the lower and upper 90% confidence limits, the rhombus <code>◊</code> the point estimate, the vertical lines <code>│</code> at 100% and the PE restriction (80.00 – 125.00%), and the double vertical lines <code>║</code> the expanded limits. The PE and CI take pre­se­dence over other symbols. In this case the upper limit of the PE restriction is not visible.<br />
Since both analyses arrive at the same conclusion, the study should be acceptable according to the Q&amp;A document.</p>
</div>
</div>
<div id="app_out" class="section level1">
<h1>Applicability, caveats, outlook</h1>
<p>The EMA’s approach of reference-scaling for highly variable drugs / drug products is currently recommended in other jurisdictions as well (<em>e.g.</em>, the WHO; ASEAN States, Australia, Brazil, the East African Community, Egypt, the Eurasian Economic Union, New Zealand, the Russian Federation).</p>
<p>The estimated <em>CV<sub>wR</sub></em> is always uncertain (the degree of uncertainty depends on the <em>CV<sub>wR</sub></em> itself, the design, and the sample size), which might lead to an inflation of the type I error (<em>i.e.</em>, if ABEL is falsely applied although the <em>true</em> – but unknown – <em>CV<sub>wR</sub></em> is lower than its estimate).<a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a><sup>,</sup> <a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a><br />
Use the optional argument <code>method.A(..., adjust = TRUE)</code> to iteratively adjust <em>α</em> to control the type I error.<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a><br />
If you want to apply the most conservative approach of Molins <em>et al.</em><a href="#fn21" class="footnote-ref" id="fnref21"><sup>21</sup></a> (which corrects for <em>CV<sub>wR</sub></em> 30% instead of the observed one), get the data.frame of results with<br />
<code>  x &lt;- method.A(..., details = TRUE, print = FALSE)</code>.<br />
Adjust <em>α</em> in library <a href="https://cran.r-project.org/package=PowerTOST">PowerTOST</a> and call <code>method.A()</code> again:<br />
<code>  design &lt;- &quot;2x2x4&quot; # your design</code><br />
<code>  n      &lt;- as.integer(strsplit(x[[6]], &quot;|&quot;, fixed = TRUE)[[1]]) # subjects / sequence</code><br />
<code>  y      &lt;- PowerTOST::scABEL.ad(CV = 0.3, n = n, design = design, print = FALSE)</code><br />
<code>  method.A(..., alpha = y$alpha.adj)</code></p>
<p>The WHO accepts <a href="https://extranet.who.int/prequal/sites/default/files/documents/AUC_criteria_November2018.pdf" title="Guidance Document, 22 November 2018">reference-scaling for AUC</a> (four period full replicate studies are mandatory in order to assess the vari­ability associated with each product). It is not evident how this assessment should be done./ In Population Bioequivalence (PBE) and Individual Bioequivalence (IBE) the <em>s<sub>wT</sub></em>/<em>s<sub>wR</sub></em> ratio was assessed and ‘similar’ variability was concluded for a ratio within 0.667 – 1.500. However, the power of comparing variabilities in a study designed to demonstrate ABE is low. This was one of the reasons why PBE and IBE were not implemented in regulatory practice. An alternative approach is given in the FDA’s <a href="https://www.accessdata.fda.gov/drugsatfda_docs/psg/Warfarin_Sodium_tab_09218_RC12-12.pdf" title="Draft recommended Dec 2012">guidance on warfarin</a> where variabilities are considered ‘comparable’ if the upper confidence limit of <em>σ<sub>wT</sub></em>/<em>σ<sub>wR</sub></em> is ≤2.5.</p>
</div>
<div id="cross" class="section level1">
<h1>Cross-validation</h1>
<p>Results of all reference datasets agree with ones obtained in SAS (9.4), Phoenix WinNonlin (6.4–8.1), STATISTICA (13), SPSS (22.0), Stata (15.0), and JMP (10.0.2).</p>
</div>
<div id="contr" class="section level1">
<h1>Contributors</h1>
<ul>
<li>Helmut Schütz (Author)</li>
<li>Michael Tomashevskiy (Contributor)</li>
<li>Detlew Labes (Contributor)</li>
</ul>
</div>
<div id="license" class="section level1">
<h1>License</h1>
<h4 class="author">
Helmut Schütz 2019-12-28
</h4>
<p><a href="https://cran.r-project.org/web/licenses/GPL-2" title="GNU General Public License, Version 2">GPL-2</a> | <a href="https://cran.r-project.org/web/licenses/GPL-3" title="GNU General Public License, Version 3">GPL-3</a></p>
</div>
<div id="disclaimer" class="section level1">
<h1>Disclaimer</h1>
<p><strong>Program offered for Use without any Guarantees and Absolutely No Warranty.<br />
No Liability is accepted for any Loss and Risk to Public Health Resulting from Use of this R-Code.</strong></p>
</div>
<div id="session" class="section level1">
<h1>Session Information</h1>
<p>Inspect this information for reproducibility. Of particular importance are the versions of R and the packages used to create this workflow. It is considered good practice to record this information with every analysis.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">options</span>(<span class="dt">width =</span> <span class="dv">80</span>)</a>
<a class="sourceLine" id="cb15-2" title="2">devtools<span class="op">::</span><span class="kw">session_info</span>()</a>
<a class="sourceLine" id="cb15-3" title="3"><span class="co"># - Session info ---------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="co">#  setting  value                       </span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="co">#  version  R version 3.6.2 (2019-12-12)</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="co">#  os       Windows 7 x64 SP 1          </span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="co">#  system   x86_64, mingw32             </span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="co">#  ui       RTerm                       </span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="co">#  language EN                          </span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="co">#  collate  C                           </span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="co">#  ctype    German_Germany.1252         </span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="co">#  tz       Europe/Vienna               </span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="co">#  date     2019-12-28                  </span></a>
<a class="sourceLine" id="cb15-14" title="14"><span class="co"># </span></a>
<a class="sourceLine" id="cb15-15" title="15"><span class="co"># - Packages -------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb15-16" title="16"><span class="co">#  package       * version     date       lib source        </span></a>
<a class="sourceLine" id="cb15-17" title="17"><span class="co">#  assertthat      0.2.1       2019-03-21 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-18" title="18"><span class="co">#  backports       1.1.5       2019-10-02 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-19" title="19"><span class="co">#  boot            1.3-24      2019-12-20 [2] CRAN (R 3.6.2)</span></a>
<a class="sourceLine" id="cb15-20" title="20"><span class="co">#  callr           3.4.0       2019-12-09 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-21" title="21"><span class="co">#  cellranger      1.1.0       2016-07-27 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-22" title="22"><span class="co">#  cli             2.0.0       2019-12-09 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-23" title="23"><span class="co">#  colorspace      1.4-1       2019-03-18 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-24" title="24"><span class="co">#  crayon          1.3.4       2017-09-16 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-25" title="25"><span class="co">#  cubature        2.0.4       2019-12-04 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-26" title="26"><span class="co">#  desc            1.2.0       2018-05-01 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-27" title="27"><span class="co">#  devtools        2.2.1       2019-09-24 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-28" title="28"><span class="co">#  digest          0.6.23      2019-11-23 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-29" title="29"><span class="co">#  dplyr           0.8.3       2019-07-04 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-30" title="30"><span class="co">#  ellipsis        0.3.0       2019-09-20 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-31" title="31"><span class="co">#  evaluate        0.14        2019-05-28 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-32" title="32"><span class="co">#  fansi           0.4.0       2018-10-05 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-33" title="33"><span class="co">#  fs              1.3.1       2019-05-06 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-34" title="34"><span class="co">#  ggplot2         3.2.1       2019-08-10 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-35" title="35"><span class="co">#  glue            1.3.1       2019-03-12 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-36" title="36"><span class="co">#  gtable          0.3.0       2019-03-25 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-37" title="37"><span class="co">#  htmltools       0.4.0       2019-10-04 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-38" title="38"><span class="co">#  knitr           1.26        2019-11-12 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-39" title="39"><span class="co">#  lattice         0.20-38     2018-11-04 [2] CRAN (R 3.6.2)</span></a>
<a class="sourceLine" id="cb15-40" title="40"><span class="co">#  lazyeval        0.2.2       2019-03-15 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-41" title="41"><span class="co">#  lifecycle       0.1.0       2019-08-01 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-42" title="42"><span class="co">#  lme4            1.1-21      2019-03-05 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-43" title="43"><span class="co">#  lmerTest        3.1-1       2019-12-13 [2] CRAN (R 3.6.2)</span></a>
<a class="sourceLine" id="cb15-44" title="44"><span class="co">#  magrittr        1.5         2014-11-22 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-45" title="45"><span class="co">#  MASS            7.3-51.5    2019-12-20 [2] CRAN (R 3.6.2)</span></a>
<a class="sourceLine" id="cb15-46" title="46"><span class="co">#  Matrix          1.2-18      2019-11-27 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-47" title="47"><span class="co">#  memoise         1.1.0       2017-04-21 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-48" title="48"><span class="co">#  minqa           1.2.4       2014-10-09 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-49" title="49"><span class="co">#  munsell         0.5.0       2018-06-12 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-50" title="50"><span class="co">#  mvtnorm         1.0-11      2019-06-19 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-51" title="51"><span class="co">#  nlme            3.1-143     2019-12-10 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-52" title="52"><span class="co">#  nloptr          1.2.1       2018-10-03 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-53" title="53"><span class="co">#  numDeriv        2016.8-1.1  2019-06-06 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-54" title="54"><span class="co">#  pbkrtest        0.4-7       2017-03-15 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-55" title="55"><span class="co">#  pillar          1.4.3       2019-12-20 [2] CRAN (R 3.6.2)</span></a>
<a class="sourceLine" id="cb15-56" title="56"><span class="co">#  pkgbuild        1.0.6       2019-10-09 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-57" title="57"><span class="co">#  pkgconfig       2.0.3       2019-09-22 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-58" title="58"><span class="co">#  pkgload         1.0.2       2018-10-29 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-59" title="59"><span class="co">#  PowerTOST       1.4-9       2019-12-19 [2] CRAN (R 3.6.2)</span></a>
<a class="sourceLine" id="cb15-60" title="60"><span class="co">#  prettyunits     1.0.2       2015-07-13 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-61" title="61"><span class="co">#  processx        3.4.1       2019-07-18 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-62" title="62"><span class="co">#  ps              1.3.0       2018-12-21 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-63" title="63"><span class="co">#  purrr           0.3.3       2019-10-18 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-64" title="64"><span class="co">#  R6              2.4.1       2019-11-12 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-65" title="65"><span class="co">#  Rcpp            1.0.3       2019-11-08 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-66" title="66"><span class="co">#  readxl          1.3.1       2019-03-13 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-67" title="67"><span class="co">#  remotes         2.1.0       2019-06-24 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-68" title="68"><span class="co">#  replicateBE   * 1.0.12.9001 2019-12-28 [1] local         </span></a>
<a class="sourceLine" id="cb15-69" title="69"><span class="co">#  rlang           0.4.2       2019-11-23 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-70" title="70"><span class="co">#  rmarkdown       2.0         2019-12-12 [2] CRAN (R 3.6.2)</span></a>
<a class="sourceLine" id="cb15-71" title="71"><span class="co">#  rprojroot       1.3-2       2018-01-03 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-72" title="72"><span class="co">#  scales          1.1.0       2019-11-18 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-73" title="73"><span class="co">#  sessioninfo     1.1.1       2018-11-05 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-74" title="74"><span class="co">#  stringi         1.4.3       2019-03-12 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-75" title="75"><span class="co">#  stringr         1.4.0       2019-02-10 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-76" title="76"><span class="co">#  TeachingDemos   2.10        2016-02-12 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-77" title="77"><span class="co">#  testthat        2.3.1       2019-12-01 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-78" title="78"><span class="co">#  tibble          2.1.3       2019-06-06 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-79" title="79"><span class="co">#  tidyselect      0.2.5       2018-10-11 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-80" title="80"><span class="co">#  tufte           0.5         2019-05-12 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-81" title="81"><span class="co">#  usethis         1.5.1       2019-07-04 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-82" title="82"><span class="co">#  withr           2.1.2       2018-03-15 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-83" title="83"><span class="co">#  xfun            0.11        2019-11-12 [2] CRAN (R 3.6.1)</span></a>
<a class="sourceLine" id="cb15-84" title="84"><span class="co">#  yaml            2.2.0       2018-07-25 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb15-85" title="85"><span class="co"># </span></a>
<a class="sourceLine" id="cb15-86" title="86"><span class="co"># [1] D:/Program Files/R/R-3.6.2/library</span></a></code></pre></div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Schütz H, Tomashevskiy M, Labes D, Shitova A, González-de la Parra M, Fuglsang A. (2019). <em>Reference Datasets for Studies in a Replicate Design intended for Average Bioequivalence with Expanding Limits.</em> Manuscript submitted for publication.<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>European Medicines Agency. <em>Annex I.</em> London, 21 September 2016. <a href="https://www.ema.europa.eu/en/documents/other/31-annex-i-statistical-analysis-methods-compatible-ema-bioequivalence-guideline_en.pdf">EMA/582648/2016</a>.<a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>European Medicines Agency, Committee for Medicinal Products for Human Use. <em>Guideline on the Investigation of Bioequivalence.</em> London, 20 January 2010. <a href="https://www.ema.europa.eu/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf">CPMP/EWP/QWP/1401/98 Rev. 1/Corr **</a>.<a href="#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>European Generic Medicines Association. <em>Revised EMA Bioequivalence Guideline. </em>3<sup>rd</sup> EGA Symposium on Bioequivalence. London, 1 June 2010. <a href="https://www.medicinesforeurope.com/wp-content/uploads/2016/03/EGA_BEQ_QA_WEB_QA_1_32.pdf">Questions &amp; Answers</a>.<a href="#fnref4" class="footnote-back">↩</a></p></li>
<li id="fn5"><p>Satterthwaite FE. <em>An Approximate Distribution of Estimates of Variance Components.</em> Biometrics Bulletin. 1946; 2(6): 110–4. <a href="https://doi.org/10.2307/3002019">doi:10.2307/3002019</a>.<a href="#fnref5" class="footnote-back">↩</a></p></li>
<li id="fn6"><p>Kenward MG, Roger JH. <em>Small Sample Inference for Fixed Effects from Restricted Maximum Likelihood.</em> Biometrics. 1997; 53(3): 983–97. <a href="https://doi.org/10.2307/2533558">doi:10.2307/2533558</a>.<a href="#fnref6" class="footnote-back">↩</a></p></li>
<li id="fn7"><p>Balaam LN. <em>A Two-Period Design with t<sup>2</sup> Experimental Units.</em> Biometrics. 1968; 24(1): 61–73. <a href="https://doi.org/10.2307/2528460">doi:10.2307/2528460</a>.<a href="#fnref7" class="footnote-back">↩</a></p></li>
<li id="fn8"><p>Chow, SC, Shao J, Wang H. <em>Individual bioequivalence testing under 2×3 designs.</em> Stat Med. 2002; 21(5): 629–48. <a href="https://doi.org/10.1002/sim.1056">doi:10.1002/sim.1056</a>.<a href="#fnref8" class="footnote-back">↩</a></p></li>
<li id="fn9"><p>Napierian logarithm (base <em>e</em>). The decadic logarithm (base 10) is not supported).<a href="#fnref9" class="footnote-back">↩</a></p></li>
<li id="fn10"><p>European Medicines Agency. <em>Questions &amp; Answers: positions on specific questions addressed to the Pharmacokinetics Working Party (PKWP).</em> London, June 2015 (and later revisons). <a href="https://www.ema.europa.eu/en/documents/scientific-guideline/questions-answers-positions-specific-questions-addressed-pharmacokinetics-working-party_en.pdf">EMA/618604/2008</a>.<a href="#fnref10" class="footnote-back">↩</a></p></li>
<li id="fn11"><p>Contradics the law of simplicity. Such a nesting is superfluous since in BE trials subjects are uniquely coded. If, say, subject <code>1</code> is allocated to sequence <code>TRTR</code> there is not yet ‘another’ subject <code>1</code> allocated to sequence <code>RTRT</code>. This explains the many lines in SAS <code>PROC GML</code> given with <code>.</code> and in Phoenix WinNonlin as <code>not estimable</code>.<a href="#fnref11" class="footnote-back">↩</a></p></li>
<li id="fn12"><p>European Medicines Agency, Committee for Medicinal Products for Human Use. <em>Guideline on the pharmacokinetic and clinical evaluation of modified release dosage forms.</em> London, 20 November 2014. <a href="https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-pharmacokinetic-clinical-evaluation-modified-release-dosage-forms_en.pdf">EMA/CHMP/EWP/280/96</a><a href="#fnref12" class="footnote-back">↩</a></p></li>
<li id="fn13"><p>Of course, only if point estimates are identical.<a href="#fnref13" class="footnote-back">↩</a></p></li>
<li id="fn14"><p>The fences are given by the lowest datum still within <em>m</em>×IQR of the lower quartile, and the highest datum still within <em>m</em>×IQR of the upper quartile, where IQR is the interquartile range (difference between the 3<sup>rd</sup> and 1<sup>st</sup> quartiles). Data outside fences are considered outliers. Decreasing the multiplier <em>m</em> to <em>e.g.</em>, 1.5 might result in many outliers, whereas increasing the multiplier in only a few.<br />
Different methods exist to calculate quartiles (nine ‘types’ are available in R, where the default is <code>type = 7</code>). R’s default is used by S, MATLAB, Octave, and Excel. Phoenix WinNonlin, Minitab, and SPSS use <code>type = 6</code>, ScyPy uses <code>type = 4</code>, whereas the default in SAS and Stata is <code>type = 2</code> (though others are available as well).<a href="#fnref14" class="footnote-back">↩</a></p></li>
<li id="fn15"><p><em>Externally</em> studentized: <span class="math inline">\(\widehat{\sigma}_{(i)}^2={1 \over n-m-1}\sum_{\begin{smallmatrix}j = 1\\j \ne i\end{smallmatrix}}^n \widehat{\varepsilon\,}_j^{\,2}\)</span><a href="#fnref15" class="footnote-back">↩</a></p></li>
<li id="fn16"><p><em>Internally</em> studentized: <span class="math inline">\(\widehat{\sigma}^2={1 \over n-m}\sum_{j=1}^n \widehat{\varepsilon\,}_j^{\,2}\)</span><a href="#fnref16" class="footnote-back">↩</a></p></li>
<li id="fn17"><p>Both are available in SAS and R, whereas only the latter in <em>e.g.</em>, Phoenix WinNonlin. In general the former are slightly more restrictive. Which one will be used has to be stated in the SAP.<a href="#fnref17" class="footnote-back">↩</a></p></li>
<li id="fn18"><p>Wonnemann M, Frömke C, Koch A. <em>Inflation of the Type I Error: Investigations on Regulatory Recommendations for Bioequivalence of Highly Variable Drugs.</em> Pharm Res. 2015; 32(1): 135–43. <a href="https://doi.org/10.1007/s11095-014-1450-z">doi:10.1007/s11095-014-1450-z</a>.<a href="#fnref18" class="footnote-back">↩</a></p></li>
<li id="fn19"><p>Muñoz J, Alcaide D, Ocaña J. <em>Consumer’s risk in the EMA and FDA regulatory approaches for bioequivalence in highly variable drugs.</em> Stat Med. 2016; 35(12): 1933–43. <a href="https://doi.org/10.1002/sim.6834">doi:10.1002/sim.6834</a>.<a href="#fnref19" class="footnote-back">↩</a></p></li>
<li id="fn20"><p>Labes D, Schütz H. <em>Inflation of Type I Error in the Evaluation of Scaled Average Bioequivalence, and a Method for its Control.</em> Pharm Res. 2016; 33(11): 2805–14. <a href="https://doi.org/10.1007/s11095-016-2006-1">doi:10.1007/s11095-016-2006-1</a>.<a href="#fnref20" class="footnote-back">↩</a></p></li>
<li id="fn21"><p>Molins E, Cobo E, Ocaña J. <em>Two-Stage Designs Versus European Scaled Average Designs in Bioequivalence Studies for Highly Variable Drugs: Which to Choose?</em> Stat Med. 2017: 36(30); 4777–88. <a href="https://doi.org/10.1002/sim.7452">doi:10.1002/sim.7452</a>.<a href="#fnref21" class="footnote-back">↩</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
